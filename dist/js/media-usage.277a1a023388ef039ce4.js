(()=>{var e={858:e=>{const t=jQuery.noConflict();e.exports=class{constructor(){"undefined"!=typeof bulkScanAjaxObject&&this.init()}init(){this.queue=bulkScanAjaxObject.attachments,this.attachments=bulkScanAjaxObject.attachments.length,this.scanChunkSize=bulkScanAjaxObject.limit,this.isScanning=!1,this.jsRunScanClickEvent(),this.jsStopScanClickEvent()}jsRunScanClickEvent(){t(document).on("click",".js-run-scan",function(e){e.preventDefault(),t(e.target).hide(),t(".js-scan-spinner").addClass("is-active"),t(".js-stop-scan").show(),this.isScanning=!0,this.runMediaScanner()}.bind(this))}jsStopScanClickEvent(){t(document).on("click",".js-stop-scan",function(e){e.preventDefault(),this.isScanning=!1,t(e.target).hide(),t(".js-scan-spinner").removeClass("is-active"),t(".js-run-scan").show()}.bind(this))}runMediaScanner(){if(0!==this.queue.length&&!1!==this.isScanning){var e=this.queue.splice(0,this.scanChunkSize);t.ajax({url:bulkScanAjaxObject.ajaxUrl,type:"post",data:{action:"scanUsageAjaxMethod",nonce:bulkScanAjaxObject.nonce,attachments:e,queue:this.queue.length},success:function(e,t){this.updateProgress(),this.runMediaScanner()}.bind(this),error:function(e,t,n){}})}else{var n=t(".js-scan-spinner");n.hasClass("is-active")&&(n.removeClass("is-active"),t(".js-stop-scan").hide(),t(".js-run-scan").show())}}updateProgress(){t(".js-scanned").length>0&&t(".js-scanned").text(this.attachments-this.queue.length),t(".js-progress").length>0&&t(".js-progress").text()!=this.getScanProgressInPrecentage()&&t(".js-progress").text(this.getScanProgressInPrecentage())}getScanProgressInPrecentage(){return Math.round((this.attachments-this.queue.length)/this.attachments*100)}}},386:e=>{const t=jQuery.noConflict();e.exports=class{constructor(){"undefined"!=typeof singleScanAjaxObject&&this.jsRefreshUsage()}jsRefreshUsage(){t(document).on("click",".js-refresh-usage",function(e){e.preventDefault(),t("#attachment_usage").addClass("is-disabled"),this.runMediaScanner()}.bind(this))}runMediaScanner(){t.ajax({url:singleScanAjaxObject.ajaxUrl,type:"post",data:{action:"scanUsageAjaxMethod",nonce:singleScanAjaxObject.nonce,attachments:[singleScanAjaxObject.attachment]},success:function(e,t){this.reRenderUsage()}.bind(this)})}reRenderUsage(){t.ajax({url:singleScanAjaxObject.ajaxUrl,type:"post",data:{action:"outputUsageListAjaxMethod",nonce:singleScanAjaxObject.nonce,attachment:singleScanAjaxObject.attachment},success:function(e,n){t("#attachment_usage").removeClass("is-disabled"),t(".js-media-usage-wrapper").html(e)}.bind(this)})}}},49:(e,t,n)=>{"use strict";const a=jQuery.noConflict(),s=n(858),i=n(386);new class{constructor(){"undefined"!=typeof getPostType&&this.jsRefreshUsage(),this.warning(),this.deleteLink(),new s,new i}deleteLink(){a(window).load((function(){let e=!1;a(document).on("click",".attachment-preview",(function(t){let n=a(".media-modal-content").find(".setting .name").next("span").find("a").prop("href"),s=a(".media-modal-content").find(".setting .name").next("span").find("a").text(),i="post.php?action=delete&post="+a(".media-modal-content .attachment-details").attr("data-id")+"&_wpnonce="+hbgmedia.rmNonce;if(s){let e;a(".media-modal-content .filename").each((function(t){0==t&&(a(this).find("strong").remove(),e=a(this).text().trim())})),a(".media-modal-content .actions .delete-attachment").remove(),a(".media-modal-content .actions").append('<a data-imgname="'+e+'"  data-url="'+n+'"  onclick="return false;" href="'+i+'" class="checkDependencies">'+hbgmedia.deleteBtn+"</a>")}e=!0})),e||a(".row-actions").each((function(){if(a(this).closest("tr").find(".parent.column-parent").find("strong").length>0){a(this).closest("tr").find(".filename span").remove();let e=a(this).closest("tr").find(".parent.column-parent a").prop("href"),t=a(this).closest("tr").find(".filename").text().trim(),n=a(this).find(".delete a").attr("href");a(this).find(".delete").addClass("hidden"),a(this).find(".edit").after('<span class="content-attached"><a data-imgname="'+t+'" data-url="'+e+'"  onclick="return false;" class="checkDependencies aria-button-if-js" href="'+n+'">'+hbgmedia.deleteBtn+"</a></span>  | ")}}))}))}warning(){a(document).on("click",".checkDependencies",(function(e){let t=new RegExp("[?&]post=([^&#]*)","i").exec(a(this).attr("data-url")),n=a(this).attr("data-imgname");if(t){let e={action:"getMediaPostTitle",nonce:hbgmedia.nonce,id:t[1]};jQuery.post(hbgmedia.url,e,(function(e){let a;if(e&&(a=confirm(hbgmedia.response+": "+e)),a){let e={action:"deleteAttachment",nonce:hbgmedia.nonce,id:t[1],post_type:"attachment",imgName:n.trim()};jQuery.post(hbgmedia.url,e,(function(e){location.href="upload.php"}))}}))}}))}}}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n(49),n(858),n(386)})();
//# sourceMappingURL=media-usage.277a1a023388ef039ce4.js.map